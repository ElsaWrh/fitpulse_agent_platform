# å¿«é€Ÿå¼€å§‹æŒ‡å—

## ä¸€é”®éƒ¨ç½²

### Windows ç”¨æˆ·

1. **ç¡®ä¿ Docker Desktop æ­£åœ¨è¿è¡Œ**

2. **æ‰“å¼€ PowerShell ç»ˆç«¯**ï¼ˆä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œï¼‰

3. **è¿›å…¥é¡¹ç›®ç›®å½•**
```powershell
cd e:\Software_Development\Health_agent_platform
```

4. **æ‰§è¡Œä¸€é”®éƒ¨ç½²è„šæœ¬**
```powershell
.\deploy.ps1
```

### Linux / macOS ç”¨æˆ·

1. **ç¡®ä¿ Docker æœåŠ¡æ­£åœ¨è¿è¡Œ**

2. **æ‰“å¼€ç»ˆç«¯**

3. **è¿›å…¥é¡¹ç›®ç›®å½•**
```bash
cd /path/to/Health_agent_platform
```

4. **æ·»åŠ æ‰§è¡Œæƒé™å¹¶è¿è¡Œ**
```bash
chmod +x deploy.sh
./deploy.sh
```

## éƒ¨ç½²è¿‡ç¨‹

è„šæœ¬å°†è‡ªåŠ¨å®Œæˆä»¥ä¸‹æ­¥éª¤ï¼š

1. âœ… æ£€æŸ¥ Docker å’Œ Docker Compose æ˜¯å¦å®‰è£…
2. âœ… æ£€æŸ¥ç«¯å£å ç”¨æƒ…å†µï¼ˆ3307, 8080, 80ï¼‰
3. âœ… åˆå§‹åŒ–ç¯å¢ƒé…ç½®æ–‡ä»¶ï¼ˆ.envï¼‰
4. âœ… åœæ­¢æ—§å®¹å™¨ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
5. âœ… æ„å»º Docker é•œåƒ
6. âœ… å¯åŠ¨æ‰€æœ‰æœåŠ¡
7. âœ… ç­‰å¾…æœåŠ¡å°±ç»ª
8. âœ… æ˜¾ç¤ºè®¿é—®åœ°å€

**é¢„è®¡è€—æ—¶ï¼š** 5-10 åˆ†é’Ÿï¼ˆå–å†³äºç½‘ç»œé€Ÿåº¦ï¼‰

## éƒ¨ç½²æˆåŠŸå

### è®¿é—®åœ°å€

- **å‰ç«¯åº”ç”¨**: http://localhost (æˆ–æŒ‡å®šçš„ç«¯å£)
- **åç«¯ API**: http://localhost:8080/api
- **æ•°æ®åº“**: localhost:3307

### é»˜è®¤è´¦å·

å¦‚æœæ•°æ®åº“å·²åˆå§‹åŒ–é»˜è®¤æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ï¼š
æ™®é€šç”¨æˆ·
- ç”¨æˆ·å: `user@fitpulse.com`
- å¯†ç : `User123!`
ç³»ç»Ÿç®¡ç†å‘˜ï¼š
- ç”¨æˆ·å: `admin@fitpulse.com`
- å¯†ç : `Admin123!`

### é…ç½® LLM API Key

å¦‚éœ€ä½¿ç”¨æ™ºèƒ½ä½“å¯¹è¯åŠŸèƒ½ï¼Œè¯·é…ç½® API Keyï¼š

1. ç¼–è¾‘ `deploy/.env` æ–‡ä»¶
2. å¡«å†™ `DASHSCOPE_API_KEY` æˆ– `OPENAI_API_KEY`
3. é‡å¯åç«¯æœåŠ¡ï¼š
```bash
cd deploy
docker-compose restart backend
```

## å¸¸ç”¨å‘½ä»¤

### Windows (PowerShell)

```powershell
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
.\deploy.ps1 status

# æŸ¥çœ‹æ—¥å¿—
.\deploy.ps1 logs
.\deploy.ps1 logs backend  # æŸ¥çœ‹åç«¯æ—¥å¿—

# åœæ­¢æœåŠ¡
.\deploy.ps1 stop

# é‡å¯æœåŠ¡
.\deploy.ps1 restart

# æ¸…ç†æ‰€æœ‰æ•°æ®ï¼ˆå±é™©æ“ä½œï¼‰
.\deploy.ps1 clean
```

### Linux / macOS (Bash)

```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
./deploy.sh status

# æŸ¥çœ‹æ—¥å¿—
./deploy.sh logs
./deploy.sh logs backend  # æŸ¥çœ‹åç«¯æ—¥å¿—

# åœæ­¢æœåŠ¡
./deploy.sh stop

# é‡å¯æœåŠ¡
./deploy.sh restart

# æ¸…ç†æ‰€æœ‰æ•°æ®ï¼ˆå±é™©æ“ä½œï¼‰
./deploy.sh clean
```

## æ‰‹åŠ¨éƒ¨ç½²ï¼ˆä¸ä½¿ç”¨è„šæœ¬ï¼‰

å¦‚æœä¸€é”®è„šæœ¬å¤±è´¥ï¼Œå¯ä»¥æ‰‹åŠ¨éƒ¨ç½²ï¼š

```bash
# 1. è¿›å…¥éƒ¨ç½²ç›®å½•
cd deploy

# 2. åˆ›å»ºç¯å¢ƒé…ç½®
cp .env.example .env

# 3. å¯åŠ¨æœåŠ¡
docker-compose up -d

# 4. æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f
```

## æ•…éšœæ’æŸ¥

### é—®é¢˜ 1: ç«¯å£è¢«å ç”¨

**é”™è¯¯ä¿¡æ¯**: `Bind for 0.0.0.0:8080 failed: port is already allocated`

**è§£å†³æ–¹æ³•**:
1. æŸ¥æ‰¾å ç”¨ç«¯å£çš„è¿›ç¨‹å¹¶å…³é—­
2. æˆ–ä¿®æ”¹ `deploy/.env` ä¸­çš„ç«¯å£é…ç½®

### é—®é¢˜ 2: Docker æœåŠ¡æœªè¿è¡Œ

**é”™è¯¯ä¿¡æ¯**: `Cannot connect to the Docker daemon`

**è§£å†³æ–¹æ³•**:
- Windows: å¯åŠ¨ Docker Desktop
- Linux: `sudo systemctl start docker`
- macOS: å¯åŠ¨ Docker.app

### é—®é¢˜ 3: æ•°æ®åº“åˆå§‹åŒ–å¤±è´¥

**ç—‡çŠ¶**: åç«¯æœåŠ¡æ— æ³•è¿æ¥æ•°æ®åº“

**è§£å†³æ–¹æ³•**:
```bash
cd deploy

# æŸ¥çœ‹æ•°æ®åº“æ—¥å¿—
docker-compose logs db

# é‡å¯æ•°æ®åº“
docker-compose restart db

# ç­‰å¾… 30 ç§’åé‡å¯åç«¯
docker-compose restart backend
```

### é—®é¢˜ 4: å‰ç«¯æ— æ³•è®¿é—®åç«¯

**ç—‡çŠ¶**: å‰ç«¯æ˜¾ç¤ºç½‘ç»œé”™è¯¯

**è§£å†³æ–¹æ³•**:
1. æ£€æŸ¥ `deploy/.env` ä¸­çš„ `VITE_API_BASE` é…ç½®
2. ç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„åç«¯åœ°å€ï¼ˆå¦‚ `http://localhost:8080/api`ï¼‰
3. é‡æ–°æ„å»ºå‰ç«¯ï¼š
```bash
cd deploy
docker-compose build frontend
docker-compose up -d frontend
```

### é—®é¢˜ 5: æ™ºèƒ½ä½“æ— æ³•å¯¹è¯

**ç—‡çŠ¶**: æ€»æ˜¯è¿”å›"æŠ±æ­‰ï¼Œæˆ‘æš‚æ—¶æ— æ³•å›ç­”æ‚¨çš„é—®é¢˜"

**åŸå› **: 
1. æœªé…ç½® LLM API Key
2. API Key æ— æ•ˆ
3. ç½‘ç»œæ— æ³•è®¿é—® LLM æœåŠ¡

**è§£å†³æ–¹æ³•**:
1. æ£€æŸ¥ `deploy/.env` ä¸­æ˜¯å¦é…ç½®äº† `DASHSCOPE_API_KEY` æˆ– `OPENAI_API_KEY`
2. éªŒè¯ API Key æ˜¯å¦æœ‰æ•ˆ
3. æŸ¥çœ‹åç«¯æ—¥å¿—ï¼š`docker-compose logs backend | grep "LLM"`

## æŸ¥çœ‹è¯¦ç»†æ—¥å¿—

### æ‰€æœ‰æœåŠ¡æ—¥å¿—
```bash
cd deploy
docker-compose logs -f
```

### å•ä¸ªæœåŠ¡æ—¥å¿—
```bash
cd deploy
docker-compose logs -f backend   # åç«¯
docker-compose logs -f frontend  # å‰ç«¯
docker-compose logs -f db        # æ•°æ®åº“
```

## åœæ­¢æœåŠ¡

### ä¿ç•™æ•°æ®
```bash
cd deploy
docker-compose down
```

### åˆ é™¤æ‰€æœ‰æ•°æ®ï¼ˆæ…ç”¨ï¼‰
```bash
cd deploy
docker-compose down -v  # -v ä¼šåˆ é™¤æ•°æ®å·
```

## æ€§èƒ½ä¼˜åŒ–å»ºè®®

### å¢åŠ  Docker èµ„æºé™åˆ¶

åœ¨ Docker Desktop è®¾ç½®ä¸­ï¼š
- CPU: å»ºè®® 4 æ ¸ä»¥ä¸Š
- å†…å­˜: å»ºè®® 4GB ä»¥ä¸Š
- ç£ç›˜: å»ºè®® 20GB ä»¥ä¸Š

### æ•°æ®åº“ä¼˜åŒ–

ç¼–è¾‘ `deploy/docker-compose.yml`ï¼Œåœ¨ db æœåŠ¡ä¸­æ·»åŠ ï¼š
```yaml
command:
  - --character-set-server=utf8mb4
  - --collation-server=utf8mb4_unicode_ci
  - --max_connections=200
  - --innodb_buffer_pool_size=256M
```

## ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æ—¶ï¼Œè¯·æ³¨æ„ï¼š

1. **ä¿®æ”¹é»˜è®¤å¯†ç **
   - æ•°æ®åº“å¯†ç : `MYSQL_ROOT_PASSWORD`
   - JWT å¯†é’¥: `JWT_SECRET`

2. **é…ç½® HTTPS**
   - ä½¿ç”¨ Nginx åå‘ä»£ç†
   - é…ç½® SSL è¯ä¹¦

3. **é…ç½®å®¹å™¨é‡å¯ç­–ç•¥**
   ```yaml
   restart: always
   ```

4. **é…ç½®æ—¥å¿—è½®è½¬**
   ```yaml
   logging:
     driver: "json-file"
     options:
       max-size: "10m"
       max-file: "3"
   ```

5. **é…ç½®å¤‡ä»½ç­–ç•¥**
   - å®šæœŸå¤‡ä»½æ•°æ®åº“
   - å¤‡ä»½ç”¨æˆ·ä¸Šä¼ çš„æ–‡ä»¶

## è·å–å¸®åŠ©

å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·ï¼š
1. æŸ¥çœ‹é¡¹ç›®æ–‡æ¡£: `docs/`
2. æŸ¥çœ‹ GitHub Issues
3. æŸ¥çœ‹éƒ¨ç½²æ—¥å¿—: `docker-compose logs`

## ä¸‹ä¸€æ­¥

éƒ¨ç½²æˆåŠŸåï¼Œå»ºè®®ï¼š
1. ğŸ“– é˜…è¯» [ç”¨æˆ·éœ€æ±‚è¯´æ˜ä¹¦](docs/ç”¨æˆ·éœ€æ±‚è¯´æ˜ä¹¦.md)
2. ğŸ”§ æŸ¥çœ‹ [API è®¾è®¡æ–‡æ¡£](docs/APIè®¾è®¡æ–‡æ¡£.md)
3. ğŸ’¾ äº†è§£ [æ•°æ®åº“è®¾è®¡](docs/æ•°æ®åº“è®¾è®¡æ–‡æ¡£.md)
4. ğŸ¯ å¼€å§‹åˆ›å»ºæ‚¨çš„ç¬¬ä¸€ä¸ªæ™ºèƒ½ä½“ï¼
