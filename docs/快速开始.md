# å¿«é€Ÿå¼€å§‹æŒ‡å—

æœ¬æ–‡æ¡£æä¾›è¯¦ç»†çš„éƒ¨ç½²æ­¥éª¤ï¼Œç¡®ä¿æ‚¨èƒ½åœ¨å…¨æ–°ç”µè„‘ä¸ŠæˆåŠŸéƒ¨ç½²ç³»ç»Ÿã€‚

## å‰ææ¡ä»¶

åœ¨å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ‚¨çš„ç”µè„‘å·²å®‰è£…ï¼š

- **Docker Desktop**ï¼ˆWindows/Macï¼‰æˆ– **Docker Engine**ï¼ˆLinuxï¼‰
  - Windows: [ä¸‹è½½ Docker Desktop](https://www.docker.com/products/docker-desktop)
  - Mac: [ä¸‹è½½ Docker Desktop](https://www.docker.com/products/docker-desktop)
  - Linux: å®‰è£… Docker Engine å’Œ Docker Compose
  
- **Git**ï¼ˆç”¨äºå…‹éš†ä»£ç ï¼‰
  - [ä¸‹è½½ Git](https://git-scm.com/downloads)

## éƒ¨ç½²æ­¥éª¤

### æ­¥éª¤ 1ï¼šå…‹éš†ä»£ç 

```bash
git clone https://github.com/yourusername/Health_agent_platform.git
cd Health_agent_platform
```

### æ­¥éª¤ 2ï¼šé…ç½®ç¯å¢ƒå˜é‡

åœ¨ `deploy/` ç›®å½•ä¸‹åˆ›å»º `.env` æ–‡ä»¶ï¼š

```bash
cd deploy
cp .env.example .env
```

ç¼–è¾‘ `.env`ï¼Œé…ç½®ä»¥ä¸‹å¿…éœ€é¡¹ï¼š

```env
# MySQL æ•°æ®åº“é…ç½®
MYSQL_ROOT_PASSWORD=123456
MYSQL_DATABASE=fitpulse_db

# Spring Boot åº”ç”¨é…ç½®
SPRING_PROFILES_ACTIVE=prod

# LLM API é…ç½®ï¼ˆè‡³å°‘é…ç½®å…¶ä¸­ä¸€ä¸ªï¼‰
OPENAI_API_KEY=your_openai_api_key_here
OPENAI_API_BASE=https://api.openai.com/v1

# æˆ–ä½¿ç”¨ DashScopeï¼ˆé˜¿é‡Œäº‘é€šä¹‰åƒé—®ï¼‰
DASHSCOPE_API_KEY=your_dashscope_api_key_here
```

> **æç¤ºï¼š** å¦‚æœæ²¡æœ‰ LLM API å¯†é’¥ï¼Œå¯ä»¥æš‚æ—¶è·³è¿‡æ­¤æ­¥éª¤ï¼Œç³»ç»Ÿå¯ä»¥æ­£å¸¸å¯åŠ¨ï¼Œä½†æ™ºèƒ½å¯¹è¯åŠŸèƒ½éœ€è¦åœ¨ç™»å½•åé€šè¿‡ä¸ªäººä¸­å¿ƒé…ç½®ã€‚

### æ­¥éª¤ 3ï¼šå¯åŠ¨æœåŠ¡

**âš ï¸ é‡è¦æç¤ºï¼šæ•°æ®åº“åˆå§‹åŒ–è¯´æ˜**

MySQL æ•°æ®åº“çš„åˆå§‹åŒ–è„šæœ¬ï¼ˆ`sql/*.sql`ï¼‰**ä»…åœ¨é¦–æ¬¡åˆ›å»ºæ•°æ®å·æ—¶æ‰§è¡Œ**ã€‚

| åœºæ™¯ | å‘½ä»¤ | æ•°æ®åº“è¡Œä¸º |
|------|------|-----------| 
| é¦–æ¬¡éƒ¨ç½² | `docker compose up -d --build` | âœ… è‡ªåŠ¨åˆå§‹åŒ–ï¼ˆåˆ›å»ºè¡¨+åˆå§‹æ•°æ®ï¼‰ |
| æ—¥å¸¸é‡å¯ | `docker compose restart` | ä¿ç•™æ‰€æœ‰æ•°æ® |
| æ›´æ–°ä»£ç  | `docker compose up -d --build` | ä¿ç•™æ‰€æœ‰æ•°æ® |
| **å®Œå…¨é‡ç½®** | `docker compose down -v && docker compose up -d --build` | âœ… é‡æ–°åˆå§‹åŒ–æ•°æ®åº“ |

**æ­£å¸¸å¯åŠ¨ï¼ˆåœ¨ deploy/ ç›®å½•æ‰§è¡Œï¼‰ï¼š**

```bash
cd deploy
docker compose up -d --build
```

**å®Œå…¨é‡ç½®æ•°æ®åº“ï¼ˆæ¨¡æ‹Ÿç©ºç™½ç”µè„‘éƒ¨ç½²ï¼‰ï¼š**

```bash
cd deploy
docker compose down -v
docker compose up -d --build
```

æŸ¥çœ‹å®¹å™¨çŠ¶æ€ï¼š

```bash
docker compose ps
```

æ‰€æœ‰å®¹å™¨çŠ¶æ€åº”ä¸º `Up (healthy)`ã€‚

### æ­¥éª¤ 4ï¼šè®¿é—®åº”ç”¨

**ç­‰å¾…çº¦ 30-60 ç§’è®©æ‰€æœ‰æœåŠ¡å®Œå…¨å¯åŠ¨åï¼Œæ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š**

| æœåŠ¡ | è®¿é—®åœ°å€ | è¯´æ˜ |
|------|---------|------|
| ğŸŒ **å‰ç«¯åº”ç”¨** | **http://localhost** | ä¸»åº”ç”¨å…¥å£ï¼ˆç™»å½•/æ³¨å†Œ/å¥åº·æ¡£æ¡ˆ/æ™ºèƒ½å¯¹è¯ï¼‰ |
| ğŸ”§ **åç«¯ API** | http://localhost:8080/api | RESTful API æ¥å£ |
| ğŸ—„ï¸ **phpMyAdmin** | http://localhost:8081 | MySQL æ•°æ®åº“ç®¡ç†ç•Œé¢ï¼ˆroot/123456ï¼‰ |
| ğŸ“Š **MySQL æ•°æ®åº“** | `localhost:3307` | æ•°æ®åº“è¿æ¥ï¼ˆç”¨æˆ·å: root, å¯†ç : 123456ï¼‰ |

### æµ‹è¯•è´¦å·

**ç®¡ç†å‘˜è´¦å·ï¼š**
- é‚®ç®±ï¼š`admin@fitpulse.com`
- å¯†ç ï¼š`Admin123!`
- æƒé™ï¼šå®Œæ•´çš„ç³»ç»Ÿç®¡ç†æƒé™

**æ™®é€šç”¨æˆ·è´¦å·ï¼š**
- é‚®ç®±ï¼š`user@fitpulse.com`
- å¯†ç ï¼š`User123!`
- æƒé™ï¼šå¥åº·æ¡£æ¡ˆç®¡ç†ã€æ™ºèƒ½å¯¹è¯ç­‰åŸºç¡€åŠŸèƒ½

## éªŒè¯éƒ¨ç½²

### 1. æ£€æŸ¥å®¹å™¨çŠ¶æ€

```bash
docker compose ps
```

æ‰€æœ‰æœåŠ¡çŠ¶æ€åº”ä¸º `Up (healthy)`ï¼š
- `health-frontend` (80:80)
- `health-backend` (8080:8080)
- `health-mysql` (3307:3306)
- `health-phpmyadmin` (8081:80)

### 2. éªŒè¯æ•°æ®åº“åˆå§‹åŒ–

```bash
docker compose exec mysql mysql -uroot -p123456 fitpulse_db -e "SHOW TABLES;"
```

åº”è¯¥æ˜¾ç¤º 19 ä¸ªè¡¨ï¼šuser, health_profile, agent, conversation ç­‰ã€‚

### 3. æ£€æŸ¥åˆå§‹ç”¨æˆ·

```bash
docker compose exec mysql mysql -uroot -p123456 fitpulse_db -e "SELECT id, email, username FROM user;"
```

åº”è¯¥æ˜¾ç¤º 2 ä¸ªåˆå§‹ç”¨æˆ·ï¼šadmin@fitpulse.com å’Œ user@fitpulse.comã€‚

### 4. æµ‹è¯•å‰ç«¯è®¿é—®

æ‰“å¼€æµè§ˆå™¨è®¿é—® http://localhostï¼Œåº”è¯¥çœ‹åˆ°ç™»å½•é¡µé¢ã€‚

### 5. æµ‹è¯•åç«¯ API

```bash
curl http://localhost:8080/api/health
```

åº”è¯¥è¿”å›å¥åº·æ£€æŸ¥ä¿¡æ¯ã€‚

## å¸¸è§é—®é¢˜

### 1. ç«¯å£è¢«å ç”¨

**é”™è¯¯ä¿¡æ¯**: `Cannot connect to the Docker daemon`

**è§£å†³æ–¹æ³•**:
- Windows: å¯åŠ¨ Docker Desktop
- Linux: `sudo systemctl start docker`
- macOS: å¯åŠ¨ Docker.app
ï¼š** `Bind for 0.0.0.0:8080 failed: port is already allocated`

**è§£å†³æ–¹æ¡ˆï¼š**

```bash
# Windows - æŸ¥æ‰¾å ç”¨ç«¯å£çš„è¿›ç¨‹
netstat -ano | findstr :80
netstat -ano | findstr :8080
netstat -ano | findstr :3307
é”™è¯¯ä¿¡æ¯ï¼š** `Cannot connect to the Docker daemon`

**è§£å†³æ–¹æ¡ˆï¼š**
- Windows: å¯åŠ¨ Docker Desktop
- Linux: `sudo systemctl start docker`
- macOS: å¯åŠ¨ Docker.app

### 3. æ•°æ®åº“æœªåˆå§‹åŒ–

**åŸå› ï¼š** æ•°æ®å·å·²å­˜åœ¨ï¼Œåˆå§‹åŒ–è„šæœ¬ä¸ä¼šé‡æ–°æ‰§è¡Œã€‚

**è§£å†³æ–¹æ¡ˆï¼š** å®Œå…¨é‡ç½®æ•°æ®åº“

```bash
cd deploy
docker compose down -v
docker compose up -d --build

# åŸå› ï¼š** é…ç½®é”™è¯¯ã€é•œåƒæ„å»ºå¤±è´¥ã€ä¾èµ–é¡¹ç¼ºå¤±

**è§£å†³æ–¹æ¡ˆï¼š**

```bash
# æŸ¥çœ‹æ‰€æœ‰å®¹å™¨æ—¥å¿—
docker compose logs

# æŸ¥çœ‹ç‰¹å®šæœåŠ¡æ—¥å¿—
docker compose logs backend
docker compose logs frontend
docker compose logs mysql

# é‡æ–°æ„å»ºå¹¶å¯åŠ¨
doåŸå› ï¼š** åç«¯æœåŠ¡æœªå°±ç»ªæˆ–å¥åº·æ£€æŸ¥æœªé€šè¿‡ã€‚

**è§£å†³æ–¹æ¡ˆï¼š**

```bash
# æŸ¥çœ‹åç«¯å®¹å™¨çŠ¶æ€
docker compose ps backend

# æŸ¥çœ‹åç«¯æ—¥å¿—
docker compose logs -f backend

# æ‰‹åŠ¨æµ‹è¯•åç«¯å¥åº·ç«¯ç‚¹
curl http://localhost:8080/api/health

# é‡å¯åç«¯æœåŠ¡
docker compose restart backend
```

### 6. ç™»å½•æ—¶æç¤º"ç”¨æˆ·ä¸å­˜åœ¨"

**åŸå› ï¼š** æ•°æ®åº“æœªåˆå§‹åŒ–æˆ–åˆå§‹ç”¨æˆ·æœªåˆ›å»ºã€‚

**è§£å†³æ–¹æ¡ˆï¼š**

```bash
# æ£€æŸ¥æ•°æ®åº“ä¸­çš„ç”¨æˆ·è¡¨
docker compose exec mysql mysql -uroot -p123456 fitpulse_db -e "SELECT id, email FROM user;"

# å¦‚æœæ²¡æœ‰ç”¨æˆ·ï¼Œé‡æ–°åˆå§‹åŒ–æ•°æ®åº“
docker compose down -v
docker compose up -d --build
```

### 7. æ™ºèƒ½å¯¹è¯åŠŸèƒ½ä¸å¯ç”¨
   ```yaml
   logging:
     driver: "json-file"
     options:
       max-size: "10m"
       max-file: "3"
   ```

5. **é…ç½®å¤‡ä»½ç­–ç•¥**
   - å®šæœŸå¤‡ä»½æ•°æ®åº“
   - å¤‡ä»½ç”¨æˆ·ä¸Šä¼ çš„æ–‡ä»¶

## è·å–å¸®åŠ©

å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·ï¼š
1. æŸ¥çœ‹é¡¹ç›®æ–‡æ¡£: `docs/`
2. æŸ¥çœ‹ GitHub Issues
3. æŸ¥çœ‹éƒ¨ç½²æ—¥å¿—: `docker-compose logs`

**ç—‡çŠ¶ï¼š** å¯¹è¯ç•Œé¢æç¤º"API å¯†é’¥æœªé…ç½®"æˆ–è¿”å›é”™è¯¯ã€‚

**åŸå› ï¼š** 
1. æœªé…ç½® LLM API Key
2. API Key æ— æ•ˆ
3. ç½‘ç»œæ— æ³•è®¿é—® LLM æœåŠ¡

**è§£å†³æ–¹æ¡ˆï¼š**

```bash
# 1. ç¼–è¾‘ç¯å¢ƒå˜é‡æ–‡ä»¶
cd deploy
nano .env  # æˆ–ä½¿ç”¨å…¶ä»–ç¼–è¾‘å™¨

# 2. æ·»åŠ æˆ–æ›´æ–°ä»¥ä¸‹é…ç½®
# DASHSCOPE_API_KEY=your_dashscope_key
# æˆ–
# OPENAI_API_KEY=your_openai_key

# 3. é‡å¯åç«¯æœåŠ¡
docker compose restart backend

# 4. æŸ¥çœ‹åç«¯æ—¥å¿—ç¡®è®¤é…ç½®åŠ è½½
docker compose logs backend | grep "LLM"
```

æˆ–è€…åœ¨ç³»ç»Ÿä¸­é…ç½®ï¼ˆç™»å½•åï¼‰ï¼š
1. è®¿é—®"ä¸ªäººä¸­å¿ƒ"
2. åœ¨"API é…ç½®"åŒºåŸŸå¡«å…¥æ‚¨çš„ API å¯†é’¥
3. ç‚¹å‡»"ä¿å­˜é…ç½®"

## æ•°æ®åº“æ“ä½œ

### æŸ¥çœ‹æ‰€æœ‰è¡¨

```bash
docker compose exec mysql mysql -uroot -p123456 fitpulse_db -e "SHOW TABLES;"
```

### æŸ¥çœ‹ç”¨æˆ·æ•°æ®

```bash
docker compose exec mysql mysql -uroot -p123456 fitpulse_db -e "SELECT * FROM user;"
```

### å¤‡ä»½æ•°æ®åº“

```bash
docker compose exec mysql mysqldump -uroot -p123456 fitpulse_db > backup_$(date +%Y%m%d).sql
```

### æ¢å¤æ•°æ®åº“

```bash
docker compose exec -T mysql mysql -uroot -p123456 fitpulse_db < backup_20240101.sql
```

## æ—¥å¸¸ç»´æŠ¤

### æŸ¥çœ‹æœåŠ¡çŠ¶æ€

```bash
docker compose ps
```

### é‡å¯æ‰€æœ‰æœåŠ¡

```bash
docker compose restart
```

### é‡å¯å•ä¸ªæœåŠ¡

```bash
docker compose restart backend
docker compose restart frontend
docker compose restart mysql
```

### æŸ¥çœ‹æ—¥å¿—

```bash
# æ‰€æœ‰æœåŠ¡æ—¥å¿—
docker compose logs -f

# å•ä¸ªæœåŠ¡æ—¥å¿—
docker compose logs -f backend
docker compose logs -f frontend
docker compose logs -f mysql
```

### åœæ­¢æœåŠ¡ï¼ˆä¿ç•™æ•°æ®ï¼‰

```bash
docker compose down
```

### å®Œå…¨æ¸…ç†ï¼ˆåˆ é™¤æ‰€æœ‰æ•°æ®ï¼‰

```bash
docker compose down -v
```

## ä¸‹ä¸€æ­¥

éƒ¨ç½²æˆåŠŸåï¼Œå»ºè®®ï¼š

1. ğŸ“– é˜…è¯» [ç”¨æˆ·éœ€æ±‚è¯´æ˜ä¹¦](ç”¨æˆ·éœ€æ±‚è¯´æ˜ä¹¦.md)
2. ğŸ”§ æŸ¥çœ‹ [API è®¾è®¡æ–‡æ¡£](APIè®¾è®¡æ–‡æ¡£.md)
3. ğŸ’¾ äº†è§£ [æ•°æ®åº“è®¾è®¡](æ•°æ®åº“è®¾è®¡æ–‡æ¡£.md)
4. ğŸ¯ å¼€å§‹ä½¿ç”¨ç³»ç»ŸåŠŸèƒ½ï¼š
   - å®Œå–„å¥åº·æ¡£æ¡ˆ
   - é…ç½® API å¯†é’¥ï¼ˆä¸ªäººä¸­å¿ƒï¼‰
   - ä½“éªŒæ™ºèƒ½å¥åº·å¯¹è¯
