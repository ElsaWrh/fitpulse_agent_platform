# FitPulse 项目启动指南

## 📋 目录
- [环境准备](#环境准备)
- [后端启动](#后端启动)
- [前端启动](#前端启动)
- [数据库配置](#数据库配置)
- [MinIO 配置](#minio-配置)
- [测试账号](#测试账号)
- [常见问题](#常见问题)

---

## 🔧 环境准备

### 必需软件
- ✅ JDK 17+
- ✅ Node.js 20+
- ✅ MySQL 8.0+
- ✅ Maven 3.8+
- ✅ Docker Desktop (用于 MinIO)

### 可选软件
- Redis 7.x (用于缓存,可选)
- MinIO (用于图片存储,可选)

---

## 🚀 快速启动 (3 步)

### 1️⃣ 启动数据库
确保 MySQL 已启动,并创建数据库:
```sql
CREATE DATABASE IF NOT EXISTS fitpulse_db 
  DEFAULT CHARACTER SET utf8mb4 
  COLLATE utf8mb4_unicode_ci;
```

执行初始化脚本:
```bash
mysql -u root -p fitpulse_db < E:\Software_Development\Health_agent_platform\sql\init.sql
```

### 2️⃣ 启动后端
```powershell
cd E:\Software_Development\Health_agent_platform\backend

# 编译项目
mvn clean package -DskipTests

# 启动服务
mvn spring-boot:run
```

**后端地址**: http://localhost:8080/api

### 3️⃣ 启动前端
```powershell
cd E:\Software_Development\Health_agent_platform\frontend

# 首次运行需要安装依赖
npm install

# 启动开发服务器
npm run dev
```

**前端地址**: http://localhost:5173

---

## 🗄️ 数据库配置

### MySQL 访问
- **主机**: localhost
- **端口**: 3306
- **数据库**: fitpulse_db
- **用户名**: root
- **密码**: 123456 (请修改为你的密码)

### phpMyAdmin 访问
- **地址**: http://localhost:8081
- **用户名**: demo_user
- **密码**: demo_pass_123

---

## 📦 MinIO 配置 (可选 - 用于图片上传)

### 启动 MinIO
```powershell
docker run -d `
  --name fitpulse-minio `
  -p 9000:9000 `
  -p 9001:9001 `
  -e MINIO_ROOT_USER=minioadmin `
  -e MINIO_ROOT_PASSWORD=minioadmin `
  minio/minio server /data --console-address ":9001"
```

### MinIO 访问
- **API 地址**: http://localhost:9000
- **控制台**: http://localhost:9001
- **用户名**: minioadmin
- **密码**: minioadmin

### 首次配置
1. 访问 http://localhost:9001
2. 登录后创建 bucket: `fitpulse-dev`
3. 设置 bucket 为 public 访问

---

## 🤖 OpenAI 配置 (可选 - 用于 AI 功能)

### 设置 API Key
```powershell
# 临时设置 (当前终端有效)
$env:OPENAI_API_KEY="sk-your-api-key-here"

# 永久设置 (系统环境变量)
# 在系统环境变量中添加 OPENAI_API_KEY
```

### 测试 API
启动后端后,上传食物图片测试 AI 识别功能

---

## 👤 测试账号

### 已有账号
- **邮箱**: 13811899957@163.com
- **密码**: Elsa123456!

### 创建新账号
访问前端注册页面: http://localhost:5173/register

---

## 🔍 验证启动成功

### 检查后端
```powershell
# 测试健康检查接口
curl http://localhost:8080/api/health

# 或在浏览器访问
http://localhost:8080/api/health
```

### 检查前端
浏览器访问: http://localhost:5173
应该能看到登录页面

### 检查数据库
```sql
USE fitpulse_db;
SHOW TABLES;
```
应该能看到所有表

---

## 🛠️ 常见问题

### ❌ 后端启动失败: "endpoint must not be null"
**原因**: 缺少 MinIO 配置

**解决方案 1** (不使用图片上传功能):
暂时注释掉 MinIO 相关配置类

**解决方案 2** (完整功能):
按照上面的步骤启动 MinIO

### ❌ 前端报错: "ERR_CONNECTION_REFUSED"
**原因**: 后端服务未启动

**解决方案**: 
```powershell
cd E:\Software_Development\Health_agent_platform\backend
mvn spring-boot:run
```

### ❌ 数据库连接失败
**原因**: MySQL 未启动或密码错误

**解决方案**:
1. 检查 MySQL 服务是否运行
2. 修改 `backend/src/main/resources/application.properties` 中的数据库密码

### ❌ Maven 编译失败
**解决方案**:
```powershell
# 清理并重新编译
mvn clean install -DskipTests -U
```

### ❌ npm 安装依赖失败
**解决方案**:
```powershell
# 清理缓存
npm cache clean --force

# 重新安装
rm -rf node_modules package-lock.json
npm install
```

---

## 📝 后端完整启动命令

```powershell
# 进入后端目录
cd E:\Software_Development\Health_agent_platform\backend

# 方式 1: 使用 Maven 直接运行
mvn spring-boot:run

# 方式 2: 打包后运行 JAR
mvn clean package -DskipTests
java -jar target/backend-0.0.1-SNAPSHOT.jar

# 方式 3: 指定配置文件
mvn spring-boot:run -Dspring-boot.run.profiles=dev
```

---

## 🌐 前端完整启动命令

```powershell
# 进入前端目录
cd E:\Software_Development\Health_agent_platform\frontend

# 开发模式
npm run dev

# 生产构建
npm run build

# 预览生产构建
npm run preview
```

---

## 🔄 GitHub 推送

```powershell
# 进入项目根目录
cd E:\Software_Development\Health_agent_platform

# 添加所有文件
git add .

# 提交
git commit -m "feat: 完成饮食拍照识别功能开发"

# 推送到远程仓库
git push -u origin main
```

---

## 📊 项目端口汇总

| 服务 | 端口 | 地址 |
|------|------|------|
| 前端 | 5173 | http://localhost:5173 |
| 后端 API | 8080 | http://localhost:8080/api |
| MySQL | 3306 | localhost:3306 |
| phpMyAdmin | 8081 | http://localhost:8081 |
| Redis | 6379 | localhost:6379 |
| MinIO API | 9000 | http://localhost:9000 |
| MinIO Console | 9001 | http://localhost:9001 |

---

## ✅ 启动检查清单

- [ ] MySQL 数据库已启动
- [ ] 数据库 `fitpulse_db` 已创建
- [ ] 数据表已初始化
- [ ] 后端服务已启动 (端口 8080)
- [ ] 前端服务已启动 (端口 5173)
- [ ] MinIO 已启动 (可选,端口 9000/9001)
- [ ] Redis 已启动 (可选,端口 6379)
- [ ] 可以访问登录页面
- [ ] 可以成功登录

---

**版本**: v1.0.0  
**最后更新**: 2025-12-06  
**文档维护**: FitPulse 开发团队
